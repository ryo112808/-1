<!doctype html>
<html lang="ja" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#ffffff" />
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="styles.css">
  <title>単語plus</title>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="brand-title">単語plus</div>
      <div class="brand-sub">貼る → 和訳つける → フラッシュで確認</div>
    </div>
    <div class="top-actions">
      <button class="btn ghost" id="themeBtn" type="button" aria-label="テーマ切替">☀︎/☾</button>
      <button class="btn ghost" id="helpBtn" type="button">使い方</button>
    </div>
  </header>

  <main class="container">
    <section class="hero card">
      <div class="hero-row">
        <div>
          <div class="hero-title">自分だけの単語帳を、コピペで作る</div>
          <div class="hero-sub">貼って追加すると <b>和訳</b> を優先で取得して保存。</div>
        </div>
        <button class="btn primary" id="openPaste" type="button">貼って追加</button>
      </div>
    </section>

    <section class="card">
      <div class="row">
        <input id="search" class="input" placeholder="検索：単語 / 和訳 / メモ / タグ" autocomplete="off" />
        <button class="btn" id="clearSearch" type="button">クリア</button>
      </div>

      <div class="chips" id="statusChips" aria-live="polite"></div>

      <div class="row">
        <button class="btn" id="toList" type="button">一覧</button>
        <button class="btn" id="toFlash" type="button">フラッシュ</button>
        <button class="btn" id="toManage" type="button">管理</button>
      </div>
    </section>

    <!-- 一覧 -->
    <section id="viewList" class="view">
      <div id="list" class="list"></div>
      <div class="card center" id="listEmpty" hidden>
        <div class="muted">まだ空。上の「貼って追加」から入れる。</div>
      </div>
    </section>

    <!-- フラッシュ（独立カード） -->
    <section id="viewFlash" class="view" hidden>
      <div class="card flash">
        <div class="flash-head">
          <div>
            <div class="card-title">フラッシュ</div>
            <div class="muted">英単語 → 答えで和訳 → 評価で次へ（出題数で終わる）</div>
          </div>
          <button class="btn danger subtle" id="exitFlash" type="button">終了</button>
        </div>

        <div class="row">
          <select id="flashCount" class="select">
            <option value="10">出題数：10</option>
            <option value="20" selected>出題数：20</option>
            <option value="30">出題数：30</option>
            <option value="50">出題数：50</option>
          </select>
          <label class="toggle">
            <input id="flashShuffle" type="checkbox" checked>
            <span>シャッフル</span>
          </label>
          <button class="btn primary" id="startFlash" type="button">開始</button>
        </div>

        <div class="flash-stage" id="flashStage" hidden>
          <div class="flash-progress" id="flashProgress">0 / 0</div>
          <div class="flash-word" id="flashWord">word</div>

          <div class="flash-answer" id="flashAnswer" hidden>
            <div class="answer-title">和訳</div>
            <div class="answer-body" id="flashJa">（未取得）</div>
          </div>

          <div class="row">
            <button class="btn" id="revealAnswer" type="button">答え</button>
            <button class="btn" id="skipCard" type="button">次へ</button>
          </div>

          <div class="grid2">
            <button class="btn rate" data-rate="0" type="button">未習得</button>
            <button class="btn rate" data-rate="1" type="button">不確か</button>
            <button class="btn rate" data-rate="2" type="button">習得</button>
            <button class="btn rate" data-rate="3" type="button">定着</button>
          </div>

          <div class="muted tiny">評価は「答え」を見た後に押せる。</div>
        </div>

        <div class="card center" id="flashEmpty" hidden>
          <div class="muted">単語が空。先に「貼って追加」。</div>
        </div>

        <div class="card center" id="flashDone" hidden>
          <div class="card-title">完了</div>
          <div class="muted">指定した出題数が終わった。</div>
          <button class="btn primary" id="backToTop" type="button">一覧へ戻る</button>
        </div>
      </div>
    </section>

    <!-- 管理（最低限） -->
    <section id="viewManage" class="view" hidden>
      <div class="card">
        <div class="card-title">管理</div>
        <div class="muted">バックアップ用。端末の中（localStorage）に保存。</div>
      </div>

      <div class="card">
        <div class="row">
          <button class="btn" id="exportBtn" type="button">エクスポート</button>
          <button class="btn" id="importBtn" type="button">インポート</button>
        </div>
        <textarea id="ioBox" class="textarea" placeholder="ここにJSONが出る / 貼る"></textarea>
        <div class="row">
          <button class="btn danger" id="trashAllBtn" type="button">全消去（ゴミ箱へ）</button>
          <button class="btn" id="undoBtn" type="button">復元</button>
        </div>
        <div class="muted tiny">完全削除は今回は入れない（事故防止）。</div>
      </div>
    </section>
  </main>

  <!-- 貼り付けモーダル -->
  <div class="modal" id="pasteModal" hidden>
    <div class="modal-backdrop" id="pasteClose"></div>
    <div class="modal-sheet" role="dialog" aria-modal="true" aria-label="貼って追加">
      <div class="modal-head">
        <div class="modal-title">貼って追加</div>
        <button class="btn ghost" id="pasteX" type="button">閉じる</button>
      </div>
      <textarea id="pasteBox" class="textarea" placeholder="英単語をまとめて貼る（改行/スペース区切り）"></textarea>
      <div class="row">
        <button class="btn" id="pasteClear" type="button">クリア</button>
        <button class="btn primary" id="pasteAdd" type="button">追加</button>
      </div>
      <div class="muted tiny">追加後、和訳は自動で順に取得（失敗してもアプリは止まらない）。</div>
    </div>
  </div>

  <!-- 使い方（スライド式・ボタン確実に効く設計） -->
  <div class="modal" id="tourModal" hidden>
    <div class="modal-backdrop" id="tourClose"></div>
    <div class="modal-sheet" role="dialog" aria-modal="true" aria-label="使い方">
      <div class="modal-head">
        <div class="modal-title">使い方</div>
        <button class="btn ghost" id="tourSkip" type="button">スキップ</button>
      </div>

      <div class="tour">
        <div class="tour-card" id="tourCard"></div>
        <div class="tour-dots" id="tourDots"></div>
        <div class="row">
          <button class="btn" id="tourPrev" type="button">戻る</button>
          <button class="btn primary" id="tourNext" type="button">次へ</button>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js" defer></script>
</body>
</html>
